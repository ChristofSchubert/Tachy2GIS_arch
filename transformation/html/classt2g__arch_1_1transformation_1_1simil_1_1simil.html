<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tachy2GIS_arch: t2g_arch.transformation.simil.simil Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tachy2GIS_arch
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classt2g__arch_1_1transformation_1_1simil_1_1simil.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classt2g__arch_1_1transformation_1_1simil_1_1simil-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">t2g_arch.transformation.simil.simil Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for t2g_arch.transformation.simil.simil:</div>
<div class="dyncontent">
<div class="center"><img src="classt2g__arch_1_1transformation_1_1simil_1_1simil__coll__graph.png" border="0" usemap="#t2g__arch_8transformation_8simil_8simil_coll__map" alt="Collaboration graph"/></div>
<map name="t2g__arch_8transformation_8simil_8simil_coll__map" id="t2g__arch_8transformation_8simil_8simil_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac4c0eec4c8279783e977b28bad03c724"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#ac4c0eec4c8279783e977b28bad03c724">__init__</a> (self)</td></tr>
<tr class="separator:ac4c0eec4c8279783e977b28bad03c724"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c6cd8f66be56bc72aed591b094a9d29"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#a4c6cd8f66be56bc72aed591b094a9d29">process</a> (source_points, target_points, alpha_0=None, scale=True, lambda_0=1.0)</td></tr>
<tr class="separator:a4c6cd8f66be56bc72aed591b094a9d29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7693ea6f257e4754b9b6dc85456d2f9b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#a7693ea6f257e4754b9b6dc85456d2f9b">_get_abc_matrices</a> (alpha_0, m1, m2=None)</td></tr>
<tr class="separator:a7693ea6f257e4754b9b6dc85456d2f9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea9ca22b938da7639d8682182fc32f38"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#aea9ca22b938da7639d8682182fc32f38">_get_blc_matrix</a> (b_matrix, lambda_i, c_matrix)</td></tr>
<tr class="separator:aea9ca22b938da7639d8682182fc32f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a063b35267dfd5fdb486fa9c4b56ece01"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#a063b35267dfd5fdb486fa9c4b56ece01">_get_d_matrix</a> (li, cs, am, blcm)</td></tr>
<tr class="separator:a063b35267dfd5fdb486fa9c4b56ece01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4adb4de3c7d4f458296ffca91ff4ca7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#aa4adb4de3c7d4f458296ffca91ff4ca7">_get_lambda_next</a> (am, bs, bm, cs, cm, rq)</td></tr>
<tr class="separator:aa4adb4de3c7d4f458296ffca91ff4ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ba743e97837c8f229b7fefe958525ad"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#a2ba743e97837c8f229b7fefe958525ad">_get_q_matrix</a> (quaternions)</td></tr>
<tr class="separator:a2ba743e97837c8f229b7fefe958525ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad68822a7662b530903145f42e5a20ce7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#ad68822a7662b530903145f42e5a20ce7">_get_r_matrix</a> (r_quat)</td></tr>
<tr class="separator:ad68822a7662b530903145f42e5a20ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0e4e132b25ffe2e7dc7b8152d996764"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#ae0e4e132b25ffe2e7dc7b8152d996764">_get_r_quat</a> (d_matrix)</td></tr>
<tr class="separator:ae0e4e132b25ffe2e7dc7b8152d996764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85eaa92958650b7fcb81de3f9a21306d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#a85eaa92958650b7fcb81de3f9a21306d">_get_s_quat</a> (c_scalar, blcm, r_quat)</td></tr>
<tr class="separator:a85eaa92958650b7fcb81de3f9a21306d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4731008fb0b59daf6543c3a39e8a0c44"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#a4731008fb0b59daf6543c3a39e8a0c44">_get_scalar</a> (alpha_0, q_coords=None)</td></tr>
<tr class="separator:a4731008fb0b59daf6543c3a39e8a0c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5813e3b27a715d17127605d32ab3ed4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#ad5813e3b27a715d17127605d32ab3ed4">_get_solution</a> (am, bs, bm, cs, cm, scale, li, i)</td></tr>
<tr class="separator:ad5813e3b27a715d17127605d32ab3ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c432c380ff89c39f10cb6d2aef5bf54"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#a0c432c380ff89c39f10cb6d2aef5bf54">_get_t_vector</a> (r_quat, s_quat)</td></tr>
<tr class="separator:a0c432c380ff89c39f10cb6d2aef5bf54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6f2fa4807aa94cb47627dc5a200863"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html#aca6f2fa4807aa94cb47627dc5a200863">_get_w_matrix</a> (quaternions)</td></tr>
<tr class="separator:aca6f2fa4807aa94cb47627dc5a200863"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"></div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac4c0eec4c8279783e977b28bad03c724"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4c0eec4c8279783e977b28bad03c724">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment"></pre> <div class="fragment"><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    <span class="keyword">def </span>__init__(self):</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7693ea6f257e4754b9b6dc85456d2f9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7693ea6f257e4754b9b6dc85456d2f9b">&#9670;&nbsp;</a></span>_get_abc_matrices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_abc_matrices </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m2</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">def </span>_get_abc_matrices(alpha_0, m1, m2=None):</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keywordflow">if</span> m2 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            matrix = np.einsum(<span class="stringliteral">&#39;i,ijk-&gt;jk&#39;</span>, alpha_0, m1)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            matrix = np.einsum(<span class="stringliteral">&#39;i,ijk-&gt;jk&#39;</span>,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                               alpha_0,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                               np.transpose(m1, (0,2,1)) @ m2)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">return</span> matrix</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="aea9ca22b938da7639d8682182fc32f38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea9ca22b938da7639d8682182fc32f38">&#9670;&nbsp;</a></span>_get_blc_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_blc_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lambda_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c_matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">def </span>_get_blc_matrix(b_matrix, lambda_i, c_matrix):</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        blc_matrix = b_matrix - lambda_i*c_matrix</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">return</span> blc_matrix</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a063b35267dfd5fdb486fa9c4b56ece01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a063b35267dfd5fdb486fa9c4b56ece01">&#9670;&nbsp;</a></span>_get_d_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_d_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>li</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>am</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>blcm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">def </span>_get_d_matrix(li, cs, am, blcm):</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        d_matrix = 2*li*am + (1/cs)*(blcm.T @ blcm)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">return</span> d_matrix</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="aa4adb4de3c7d4f458296ffca91ff4ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4adb4de3c7d4f458296ffca91ff4ca7">&#9670;&nbsp;</a></span>_get_lambda_next()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_lambda_next </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>am</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keyword">def </span>_get_lambda_next(am, bs, bm, cs, cm, rq):</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        expr_1 = rq.T @ am @ rq</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        expr_2 = (1/cs) * (rq.T @ bm.T @ cm @ rq)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        expr_3 = (1/cs) * (rq.T @ cm.T @ cm @ rq)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        lambda_next = (expr_1-expr_2) / (bs-expr_3)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">return</span> lambda_next</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a2ba743e97837c8f229b7fefe958525ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ba743e97837c8f229b7fefe958525ad">&#9670;&nbsp;</a></span>_get_q_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_q_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>quaternions</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keyword">def </span>_get_q_matrix(quaternions):</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        q_matrix = [[[q[3], -q[2], q[1], q[0]],</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                     [q[2], q[3] , -q[0], q[1]],</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                     [-q[1], q[0], q[3], q[2]],</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                     [-q[0], -q[1], -q[2], q[3]]] <span class="keywordflow">for</span> q <span class="keywordflow">in</span> quaternions]</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keywordflow">return</span> np.array(q_matrix)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ad68822a7662b530903145f42e5a20ce7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad68822a7662b530903145f42e5a20ce7">&#9670;&nbsp;</a></span>_get_r_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_r_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r_quat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">def </span>_get_r_matrix(r_quat):</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        r_w_matrix = simil._get_w_matrix([r_quat])[0]</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        r_q_matrix = simil._get_q_matrix([r_quat])[0]</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        r_matrix = (r_w_matrix.T @ r_q_matrix)[:3,:3]</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">return</span> r_matrix</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ae0e4e132b25ffe2e7dc7b8152d996764"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0e4e132b25ffe2e7dc7b8152d996764">&#9670;&nbsp;</a></span>_get_r_quat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_r_quat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d_matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">def </span>_get_r_quat(d_matrix):</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        eigvals, eigvects = np.linalg.eig(d_matrix)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        beta_1 = np.argmax(eigvals)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        r_quat = eigvects[:,beta_1]</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">return</span> beta_1, r_quat</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a85eaa92958650b7fcb81de3f9a21306d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85eaa92958650b7fcb81de3f9a21306d">&#9670;&nbsp;</a></span>_get_s_quat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_s_quat </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c_scalar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>blcm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r_quat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keyword">def </span>_get_s_quat(c_scalar, blcm, r_quat):</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        s_quat = 1/(2*c_scalar) * (blcm @ r_quat)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">return</span> s_quat</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a4731008fb0b59daf6543c3a39e8a0c44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4731008fb0b59daf6543c3a39e8a0c44">&#9670;&nbsp;</a></span>_get_scalar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_scalar </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>q_coords</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keyword">def </span>_get_scalar(alpha_0, q_coords=None):</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <span class="keywordflow">if</span> q_coords <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;            scalar = np.einsum(<span class="stringliteral">&#39;i-&gt;&#39;</span>, alpha_0)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;            scalar = np.einsum(<span class="stringliteral">&#39;i,i-&gt;&#39;</span>, alpha_0, (q_coords * q_coords).sum(0))</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keywordflow">return</span> scalar</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ad5813e3b27a715d17127605d32ab3ed4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5813e3b27a715d17127605d32ab3ed4">&#9670;&nbsp;</a></span>_get_solution()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_solution </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>am</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>li</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">def </span>_get_solution(am, bs, bm, cs, cm, scale, li, i):</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        blc_matrix = simil._get_blc_matrix(bm, li, cm)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        d_matrix = simil._get_d_matrix(li, cs, am, blc_matrix)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        beta_1, r_quat =simil. _get_r_quat(d_matrix)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">if</span> scale <span class="keywordflow">is</span> <span class="keyword">False</span>:</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">return</span> blc_matrix, d_matrix, beta_1, r_quat, li, i</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            lambda_next = simil._get_lambda_next(am, bs, bm, cs, cm, r_quat)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">if</span> abs(li-lambda_next) &lt; 0.000001:</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="keywordflow">return</span> blc_matrix, d_matrix, beta_1, r_quat, li, i</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                li, i = lambda_next, i+1</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="keywordflow">return</span> simil._get_solution(am, bs, bm, cs, cm, scale, li, i)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a0c432c380ff89c39f10cb6d2aef5bf54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c432c380ff89c39f10cb6d2aef5bf54">&#9670;&nbsp;</a></span>_get_t_vector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_t_vector </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r_quat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_quat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">def </span>_get_t_vector(r_quat, s_quat):</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        r_w_matrix = simil._get_w_matrix([r_quat])[0]</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        t_vector = [2 * (r_w_matrix.T @ s_quat)[:3]]</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> t_vector</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="aca6f2fa4807aa94cb47627dc5a200863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca6f2fa4807aa94cb47627dc5a200863">&#9670;&nbsp;</a></span>_get_w_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil._get_w_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>quaternions</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">def </span>_get_w_matrix(quaternions):</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        w_matrix = [[[q[3], q[2], -q[1], q[0]],</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                     [-q[2], q[3] , q[0], q[1]],</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                     [q[1], -q[0], q[3], q[2]],</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                     [-q[0], -q[1], -q[2], q[3]]] <span class="keywordflow">for</span> q <span class="keywordflow">in</span> quaternions]</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">return</span> np.array(w_matrix)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a4c6cd8f66be56bc72aed591b094a9d29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c6cd8f66be56bc72aed591b094a9d29">&#9670;&nbsp;</a></span>process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def t2g_arch.transformation.simil.simil.process </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>source_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha_0</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scale</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lambda_0</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find similarity transformation parameters given a set of control points

Parameters
----------
source_points : array_like
    The function will try to cast it to a numpy array with shape:
    ``(n, 3)``, where ``n`` is the number of points.
    Two points is the minimum requeriment (in that case, the solution
    will map well all points that belong in the rect that passes
    through both control points).
target_points : array_like
    The function will try to cast it to a numpy array with shape:
    ``(n, 3)``, where ``n`` is the number of points.
    The function will check that there are as many target points
    as source points.
alpha_0 : array_like, optional
    Per point weights.
    If provided, the function will try to cast to a numpy array with
    shape: ``(n,)``.
scale : boolean, optional
    Allow to find a multiplier factor different from lambda_0.
    Default is True.
lambda_0 : float, optional
    Multiplier factor to find the first solution. Default is 1.0.
    If `scale=True`, a recursion is implemented to find a better
    value. If it is negative, forces mirroring. Can't be zero.

Returns
-------
lambda_i : float
    Multiplier factor.
r_matrix : numpy.ndarray
    Rotation matrix.
t_vector : numpy.ndarray
    Translation (column) vector.
</pre> <div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                lambda_0=1.0):</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="stringliteral">        Find similarity transformation parameters given a set of control points</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="stringliteral">        Parameters</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="stringliteral">        ----------</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="stringliteral">        source_points : array_like</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="stringliteral">            The function will try to cast it to a numpy array with shape:</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="stringliteral">            ``(n, 3)``, where ``n`` is the number of points.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="stringliteral">            Two points is the minimum requeriment (in that case, the solution</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="stringliteral">            will map well all points that belong in the rect that passes</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="stringliteral">            through both control points).</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="stringliteral">        target_points : array_like</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="stringliteral">            The function will try to cast it to a numpy array with shape:</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="stringliteral">            ``(n, 3)``, where ``n`` is the number of points.</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="stringliteral">            The function will check that there are as many target points</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="stringliteral">            as source points.</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="stringliteral">        alpha_0 : array_like, optional</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="stringliteral">            Per point weights.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="stringliteral">            If provided, the function will try to cast to a numpy array with</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="stringliteral">            shape: ``(n,)``.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="stringliteral">        scale : boolean, optional</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="stringliteral">            Allow to find a multiplier factor different from lambda_0.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="stringliteral">            Default is True.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="stringliteral">        lambda_0 : float, optional</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="stringliteral">            Multiplier factor to find the first solution. Default is 1.0.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="stringliteral">            If `scale=True`, a recursion is implemented to find a better</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="stringliteral">            value. If it is negative, forces mirroring. Can&#39;t be zero.</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="stringliteral">        Returns</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral">        -------</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">        lambda_i : float</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">            Multiplier factor.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="stringliteral">        r_matrix : numpy.ndarray</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral">            Rotation matrix.</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral">        t_vector : numpy.ndarray</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="stringliteral">            Translation (column) vector.</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment"># declarations and checkups</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        source_coords = np.array(source_points, dtype=float).T</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span> source_coords.ndim != 2:</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            err_msg = (<span class="stringliteral">&#39;source_points array must have dimension = 2.&#39;</span>)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> source_coords.shape[0] != 3:</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            err_msg = (<span class="stringliteral">&#39;There are not three coordinates in source points.&#39;</span>)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        n = source_coords.shape[1]</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (n == 1 <span class="keywordflow">or</span> (source_coords[<span class="keywordtype">None</span>,0] == source_coords).all()):</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            err_msg = (<span class="stringliteral">&#39;There are not two distinct source points.&#39;</span>)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        target_coords = np.array(target_points, dtype=float).T</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> target_coords.ndim != 2:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            err_msg = (<span class="stringliteral">&#39;target_points array must have dimension = 2.&#39;</span>)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> target_coords.shape[0] != 3:</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            err_msg = (<span class="stringliteral">&#39;There are not three coordinates in target points.&#39;</span>)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> target_coords.shape[1] != n:</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            err_msg = (<span class="stringliteral">&#39;There are not as many target points as source points.&#39;</span>)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> alpha_0 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            alpha_0 = np.ones(n)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            alpha_0 = np.array(alpha_0, dtype=float)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> alpha_0.ndim != 1:</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            err_msg = (<span class="stringliteral">&#39;alpha_0 array must have dimension = 1.&#39;</span>)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">if</span> alpha_0.shape != (n,):</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            err_msg = (<span class="stringliteral">&#39;There are not as many alpha_0 coefficients as &#39;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                       <span class="stringliteral">&#39;control points.&#39;</span>)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        lambda_0 = float(lambda_0)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span> lambda_0 == 0:</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            err_msg = (<span class="stringliteral">&#39;lambda_0 cannot be zero.&#39;</span>)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">raise</span> ValueError(err_msg)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment"># processes</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        source_q_coords = np.concatenate((source_coords,np.zeros((1,n))))</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        target_q_coords = np.concatenate((target_coords,np.zeros((1,n))))</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        b_scalar = simil._get_scalar(alpha_0, source_q_coords)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        c_scalar = np.einsum(<span class="stringliteral">&#39;i-&gt;&#39;</span>, alpha_0)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        q0_w_matrix = simil._get_w_matrix(source_q_coords.T)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        qt_q_matrix = simil._get_q_matrix(target_q_coords.T)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        a_matrix = simil._get_abc_matrices(alpha_0, q0_w_matrix, qt_q_matrix)</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        b_matrix = simil._get_abc_matrices(alpha_0, qt_q_matrix)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        c_matrix = simil._get_abc_matrices(alpha_0, q0_w_matrix)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        lambda_i, i = lambda_0 , 1</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        blc_matrix, d_matrix, beta_1, r_quat, lambda_i, i = simil._get_solution(a_matrix,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                                                          b_scalar,</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                                                          b_matrix,</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                                                          c_scalar,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                                                          c_matrix,</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                                                          scale,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                                                          lambda_i,</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                                                          i)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        r_matrix = simil._get_r_matrix(r_quat)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        s_quat = simil._get_s_quat(c_scalar, blc_matrix, r_quat)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        t_vector = np.array(simil._get_t_vector(r_quat, s_quat)).reshape(3,1)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">return</span> lambda_i, r_matrix, t_vector</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="">simil.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacet2g__arch.html">t2g_arch</a></li><li class="navelem"><a class="el" href="namespacet2g__arch_1_1transformation.html">transformation</a></li><li class="navelem"><a class="el" href="namespacet2g__arch_1_1transformation_1_1simil.html">simil</a></li><li class="navelem"><a class="el" href="classt2g__arch_1_1transformation_1_1simil_1_1simil.html">simil</a></li>
    <li class="footer">Generated on Tue Nov 3 2020 11:39:18 for Tachy2GIS_arch by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
